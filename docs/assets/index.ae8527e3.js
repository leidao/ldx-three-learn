var Ut=Object.defineProperty;var zt=(i,t,e)=>t in i?Ut(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var B=(i,t,e)=>(zt(i,typeof t!="symbol"?t+"":t,e),e);import{r as x,w as ue,m as me,i as se,s as oe,k as Wt,t as Gt,l as Bt,n as St,o as Ht,p as ut,q as Yt,d as lt,C as nt,v as Xt,a as Ae,D as Kt,c as At,_ as ve,S as Qt,x as Zt,j as Ce,b as Jt}from"./index.5ab62cdf.js";import{V as Q,Q as ct,G as Te,T as er,F as tr,C as rr,h as nr,ao as ie,ap as ir,b as Me,a0 as $e,M as De,a3 as Oe,Y as ft,a9 as ar,p as or,aq as sr,ar as ur,$ as lr,as as cr,a8 as dt,at as fr,au as Ie,f as dr,av as hr,aa as vr,n as pr,aw as gr}from"./LoadingBar.98c96aab.js";import{V as mr}from"./index.cb3f22ab.js";import{F as yr}from"./FontLoader.92505dcd.js";import{C as br,a as wr}from"./CSS3DRenderer.177a6146.js";function Fr(i){return Object.keys(i).reduce(function(t,e){return(e.startsWith("data-")||e.startsWith("aria-")||e==="role")&&!e.startsWith("data-__")&&(t[e]=i[e]),t},{})}function Le(){return Le=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r])}return i},Le.apply(this,arguments)}function xr(i,t){if(i==null)return{};var e={},r=Object.keys(i),n,a;for(a=0;a<r.length;a++)n=r[a],!(t.indexOf(n)>=0)&&(e[n]=i[n]);return e}function it(i,t){if(i==null)return{};var e=xr(i,t),r,n;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);for(n=0;n<a.length;n++)r=a[n],!(t.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(i,r)||(e[r]=i[r]))}return e}function ee(i){return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(i)}function ne(){ne=function(){return t};var i,t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(P,g,b){P[g]=b.value},a=typeof Symbol=="function"?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(P,g,b){return Object.defineProperty(P,g,{value:b,enumerable:!0,configurable:!0,writable:!0}),P[g]}try{l({},"")}catch{l=function(b,L,N){return b[L]=N}}function c(P,g,b,L){var N=g&&g.prototype instanceof d?g:d,_=Object.create(N.prototype),D=new G(L||[]);return n(_,"_invoke",{value:A(P,b,D)}),_}function f(P,g,b){try{return{type:"normal",arg:P.call(g,b)}}catch(L){return{type:"throw",arg:L}}}t.wrap=c;var v="suspendedStart",E="suspendedYield",F="executing",h="completed",p={};function d(){}function w(){}function m(){}var V={};l(V,o,function(){return this});var R=Object.getPrototypeOf,C=R&&R(R(z([])));C&&C!==e&&r.call(C,o)&&(V=C);var O=m.prototype=d.prototype=Object.create(V);function M(P){["next","throw","return"].forEach(function(g){l(P,g,function(b){return this._invoke(g,b)})})}function S(P,g){function b(N,_,D,H){var K=f(P[N],P,_);if(K.type!=="throw"){var te=K.arg,ae=te.value;return ae&&ee(ae)=="object"&&r.call(ae,"__await")?g.resolve(ae.__await).then(function(le){b("next",le,D,H)},function(le){b("throw",le,D,H)}):g.resolve(ae).then(function(le){te.value=le,D(te)},function(le){return b("throw",le,D,H)})}H(K.arg)}var L;n(this,"_invoke",{value:function(_,D){function H(){return new g(function(K,te){b(_,D,K,te)})}return L=L?L.then(H,H):H()}})}function A(P,g,b){var L=v;return function(N,_){if(L===F)throw new Error("Generator is already running");if(L===h){if(N==="throw")throw _;return{value:i,done:!0}}for(b.method=N,b.arg=_;;){var D=b.delegate;if(D){var H=j(D,b);if(H){if(H===p)continue;return H}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(L===v)throw L=h,b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);L=F;var K=f(P,g,b);if(K.type==="normal"){if(L=b.done?h:E,K.arg===p)continue;return{value:K.arg,done:b.done}}K.type==="throw"&&(L=h,b.method="throw",b.arg=K.arg)}}}function j(P,g){var b=g.method,L=P.iterator[b];if(L===i)return g.delegate=null,b==="throw"&&P.iterator.return&&(g.method="return",g.arg=i,j(P,g),g.method==="throw")||b!=="return"&&(g.method="throw",g.arg=new TypeError("The iterator does not provide a '"+b+"' method")),p;var N=f(L,P.iterator,g.arg);if(N.type==="throw")return g.method="throw",g.arg=N.arg,g.delegate=null,p;var _=N.arg;return _?_.done?(g[P.resultName]=_.value,g.next=P.nextLoc,g.method!=="return"&&(g.method="next",g.arg=i),g.delegate=null,p):_:(g.method="throw",g.arg=new TypeError("iterator result is not an object"),g.delegate=null,p)}function k(P){var g={tryLoc:P[0]};1 in P&&(g.catchLoc=P[1]),2 in P&&(g.finallyLoc=P[2],g.afterLoc=P[3]),this.tryEntries.push(g)}function T(P){var g=P.completion||{};g.type="normal",delete g.arg,P.completion=g}function G(P){this.tryEntries=[{tryLoc:"root"}],P.forEach(k,this),this.reset(!0)}function z(P){if(P||P===""){var g=P[o];if(g)return g.call(P);if(typeof P.next=="function")return P;if(!isNaN(P.length)){var b=-1,L=function N(){for(;++b<P.length;)if(r.call(P,b))return N.value=P[b],N.done=!1,N;return N.value=i,N.done=!0,N};return L.next=L}}throw new TypeError(ee(P)+" is not iterable")}return w.prototype=m,n(O,"constructor",{value:m,configurable:!0}),n(m,"constructor",{value:w,configurable:!0}),w.displayName=l(m,u,"GeneratorFunction"),t.isGeneratorFunction=function(P){var g=typeof P=="function"&&P.constructor;return!!g&&(g===w||(g.displayName||g.name)==="GeneratorFunction")},t.mark=function(P){return Object.setPrototypeOf?Object.setPrototypeOf(P,m):(P.__proto__=m,l(P,u,"GeneratorFunction")),P.prototype=Object.create(O),P},t.awrap=function(P){return{__await:P}},M(S.prototype),l(S.prototype,s,function(){return this}),t.AsyncIterator=S,t.async=function(P,g,b,L,N){N===void 0&&(N=Promise);var _=new S(c(P,g,b,L),N);return t.isGeneratorFunction(g)?_:_.next().then(function(D){return D.done?D.value:_.next()})},M(O),l(O,u,"Generator"),l(O,o,function(){return this}),l(O,"toString",function(){return"[object Generator]"}),t.keys=function(P){var g=Object(P),b=[];for(var L in g)b.push(L);return b.reverse(),function N(){for(;b.length;){var _=b.pop();if(_ in g)return N.value=_,N.done=!1,N}return N.done=!0,N}},t.values=z,G.prototype={constructor:G,reset:function(g){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(T),!g)for(var b in this)b.charAt(0)==="t"&&r.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=i)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if(g.type==="throw")throw g.arg;return this.rval},dispatchException:function(g){if(this.done)throw g;var b=this;function L(te,ae){return D.type="throw",D.arg=g,b.next=te,ae&&(b.method="next",b.arg=i),!!ae}for(var N=this.tryEntries.length-1;N>=0;--N){var _=this.tryEntries[N],D=_.completion;if(_.tryLoc==="root")return L("end");if(_.tryLoc<=this.prev){var H=r.call(_,"catchLoc"),K=r.call(_,"finallyLoc");if(H&&K){if(this.prev<_.catchLoc)return L(_.catchLoc,!0);if(this.prev<_.finallyLoc)return L(_.finallyLoc)}else if(H){if(this.prev<_.catchLoc)return L(_.catchLoc,!0)}else{if(!K)throw new Error("try statement without catch or finally");if(this.prev<_.finallyLoc)return L(_.finallyLoc)}}}},abrupt:function(g,b){for(var L=this.tryEntries.length-1;L>=0;--L){var N=this.tryEntries[L];if(N.tryLoc<=this.prev&&r.call(N,"finallyLoc")&&this.prev<N.finallyLoc){var _=N;break}}_&&(g==="break"||g==="continue")&&_.tryLoc<=b&&b<=_.finallyLoc&&(_=null);var D=_?_.completion:{};return D.type=g,D.arg=b,_?(this.method="next",this.next=_.finallyLoc,p):this.complete(D)},complete:function(g,b){if(g.type==="throw")throw g.arg;return g.type==="break"||g.type==="continue"?this.next=g.arg:g.type==="return"?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):g.type==="normal"&&b&&(this.next=b),p},finish:function(g){for(var b=this.tryEntries.length-1;b>=0;--b){var L=this.tryEntries[b];if(L.finallyLoc===g)return this.complete(L.completion,L.afterLoc),T(L),p}},catch:function(g){for(var b=this.tryEntries.length-1;b>=0;--b){var L=this.tryEntries[b];if(L.tryLoc===g){var N=L.completion;if(N.type==="throw"){var _=N.arg;T(L)}return _}}throw new Error("illegal catch attempt")},delegateYield:function(g,b,L){return this.delegate={iterator:z(g),resultName:b,nextLoc:L},this.method==="next"&&(this.arg=i),p}},t}function ht(i,t,e,r,n,a,o){try{var s=i[a](o),u=s.value}catch(l){e(l);return}s.done?t(u):Promise.resolve(u).then(r,n)}function xe(i){return function(){var t=this,e=arguments;return new Promise(function(r,n){var a=i.apply(t,e);function o(u){ht(a,r,n,o,s,"next",u)}function s(u){ht(a,r,n,o,s,"throw",u)}o(void 0)})}}function Pr(i,t){if(ee(i)!=="object"||i===null)return i;var e=i[Symbol.toPrimitive];if(e!==void 0){var r=e.call(i,t||"default");if(ee(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(i)}function Lt(i){var t=Pr(i,"string");return ee(t)==="symbol"?t:String(t)}function y(i,t,e){return t=Lt(t),t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e,i}function vt(i,t){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(i);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),e.push.apply(e,r)}return e}function I(i){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?vt(Object(e),!0).forEach(function(r){y(i,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):vt(Object(e)).forEach(function(r){Object.defineProperty(i,r,Object.getOwnPropertyDescriptor(e,r))})}return i}function We(i,t){(t==null||t>i.length)&&(t=i.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=i[e];return r}function Er(i){if(Array.isArray(i))return We(i)}function Cr(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function _t(i,t){if(!!i){if(typeof i=="string")return We(i,t);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return We(i,t)}}function Or(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U(i){return Er(i)||Cr(i)||_t(i)||Or()}function at(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function pt(i,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,Lt(r.key),r)}}function ot(i,t,e){return t&&pt(i.prototype,t),e&&pt(i,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function q(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Ge(i,t){return Ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Ge(i,t)}function Vr(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),t&&Ge(i,t)}function _e(i){return _e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_e(i)}function Rr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sr(i,t){if(t&&(ee(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q(i)}function Ar(i){var t=Rr();return function(){var r=_e(i),n;if(t){var a=_e(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Sr(this,n)}}var ce="RC_FORM_INTERNAL_HOOKS",W=function(){ue(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},ge=x.exports.createContext({getFieldValue:W,getFieldsValue:W,getFieldError:W,getFieldWarning:W,getFieldsError:W,isFieldsTouched:W,isFieldTouched:W,isFieldValidating:W,isFieldsValidating:W,resetFields:W,setFields:W,setFieldValue:W,setFieldsValue:W,validateFields:W,submit:W,getInternalHooks:function(){return W(),{dispatch:W,initEntityValue:W,registerField:W,useSubscribe:W,setInitialValues:W,destroyForm:W,setCallbacks:W,registerWatch:W,getFields:W,setValidateMessages:W,setPreserve:W,getInitialValue:W}}}),ke=x.exports.createContext(null);function Be(i){return i==null?[]:Array.isArray(i)?i:[i]}function Lr(i){return i&&!!i._init}function fe(){return fe=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r])}return i},fe.apply(this,arguments)}function _r(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i,we(i,t)}function He(i){return He=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},He(i)}function we(i,t){return we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},we(i,t)}function kr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Se(i,t,e){return kr()?Se=Reflect.construct.bind():Se=function(n,a,o){var s=[null];s.push.apply(s,a);var u=Function.bind.apply(n,s),l=new u;return o&&we(l,o.prototype),l},Se.apply(null,arguments)}function Nr(i){return Function.toString.call(i).indexOf("[native code]")!==-1}function Ye(i){var t=typeof Map=="function"?new Map:void 0;return Ye=function(r){if(r===null||!Nr(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(r))return t.get(r);t.set(r,n)}function n(){return Se(r,arguments,He(this).constructor)}return n.prototype=Object.create(r.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),we(n,r)},Ye(i)}var jr=/%[sdj%]/g,Tr=function(){};typeof process!="undefined"&&process.env;function Xe(i){if(!i||!i.length)return null;var t={};return i.forEach(function(e){var r=e.field;t[r]=t[r]||[],t[r].push(e)}),t}function J(i){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];var n=0,a=e.length;if(typeof i=="function")return i.apply(null,e);if(typeof i=="string"){var o=i.replace(jr,function(s){if(s==="%%")return"%";if(n>=a)return s;switch(s){case"%s":return String(e[n++]);case"%d":return Number(e[n++]);case"%j":try{return JSON.stringify(e[n++])}catch{return"[Circular]"}break;default:return s}});return o}return i}function Mr(i){return i==="string"||i==="url"||i==="hex"||i==="email"||i==="date"||i==="pattern"}function X(i,t){return!!(i==null||t==="array"&&Array.isArray(i)&&!i.length||Mr(t)&&typeof i=="string"&&!i)}function $r(i,t,e){var r=[],n=0,a=i.length;function o(s){r.push.apply(r,s||[]),n++,n===a&&e(r)}i.forEach(function(s){t(s,o)})}function gt(i,t,e){var r=0,n=i.length;function a(o){if(o&&o.length){e(o);return}var s=r;r=r+1,s<n?t(i[s],a):e([])}a([])}function Dr(i){var t=[];return Object.keys(i).forEach(function(e){t.push.apply(t,i[e]||[])}),t}var mt=function(i){_r(t,i);function t(e,r){var n;return n=i.call(this,"Async Validation Error")||this,n.errors=e,n.fields=r,n}return t}(Ye(Error));function Ir(i,t,e,r,n){if(t.first){var a=new Promise(function(v,E){var F=function(d){return r(d),d.length?E(new mt(d,Xe(d))):v(n)},h=Dr(i);gt(h,e,F)});return a.catch(function(v){return v}),a}var o=t.firstFields===!0?Object.keys(i):t.firstFields||[],s=Object.keys(i),u=s.length,l=0,c=[],f=new Promise(function(v,E){var F=function(p){if(c.push.apply(c,p),l++,l===u)return r(c),c.length?E(new mt(c,Xe(c))):v(n)};s.length||(r(c),v(n)),s.forEach(function(h){var p=i[h];o.indexOf(h)!==-1?gt(p,e,F):$r(p,e,F)})});return f.catch(function(v){return v}),f}function qr(i){return!!(i&&i.message!==void 0)}function Ur(i,t){for(var e=i,r=0;r<t.length;r++){if(e==null)return e;e=e[t[r]]}return e}function yt(i,t){return function(e){var r;return i.fullFields?r=Ur(t,i.fullFields):r=t[e.field||i.fullField],qr(e)?(e.field=e.field||i.fullField,e.fieldValue=r,e):{message:typeof e=="function"?e():e,fieldValue:r,field:e.field||i.fullField}}}function bt(i,t){if(t){for(var e in t)if(t.hasOwnProperty(e)){var r=t[e];typeof r=="object"&&typeof i[e]=="object"?i[e]=fe({},i[e],r):i[e]=r}}return i}var kt=function(t,e,r,n,a,o){t.required&&(!r.hasOwnProperty(t.field)||X(e,o||t.type))&&n.push(J(a.messages.required,t.fullField))},zr=function(t,e,r,n,a){(/^\s+$/.test(e)||e==="")&&n.push(J(a.messages.whitespace,t.fullField))},Ve,Wr=function(){if(Ve)return Ve;var i="[a-fA-F\\d:]",t=function(V){return V&&V.includeBoundaries?"(?:(?<=\\s|^)(?="+i+")|(?<="+i+")(?=\\s|$))":""},e="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",r="[a-fA-F\\d]{1,4}",n=(`
(?:
(?:`+r+":){7}(?:"+r+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+r+":){6}(?:"+e+"|:"+r+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+r+":){5}(?::"+e+"|(?::"+r+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+r+":){4}(?:(?::"+r+"){0,1}:"+e+"|(?::"+r+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+r+":){3}(?:(?::"+r+"){0,2}:"+e+"|(?::"+r+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+r+":){2}(?:(?::"+r+"){0,3}:"+e+"|(?::"+r+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+r+":){1}(?:(?::"+r+"){0,4}:"+e+"|(?::"+r+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+r+"){0,5}:"+e+"|(?::"+r+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),a=new RegExp("(?:^"+e+"$)|(?:^"+n+"$)"),o=new RegExp("^"+e+"$"),s=new RegExp("^"+n+"$"),u=function(V){return V&&V.exact?a:new RegExp("(?:"+t(V)+e+t(V)+")|(?:"+t(V)+n+t(V)+")","g")};u.v4=function(m){return m&&m.exact?o:new RegExp(""+t(m)+e+t(m),"g")},u.v6=function(m){return m&&m.exact?s:new RegExp(""+t(m)+n+t(m),"g")};var l="(?:(?:[a-z]+:)?//)",c="(?:\\S+(?::\\S*)?@)?",f=u.v4().source,v=u.v6().source,E="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",F="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",h="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",p="(?::\\d{2,5})?",d='(?:[/?#][^\\s"]*)?',w="(?:"+l+"|www\\.)"+c+"(?:localhost|"+f+"|"+v+"|"+E+F+h+")"+p+d;return Ve=new RegExp("(?:^"+w+"$)","i"),Ve},wt={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},ye={integer:function(t){return ye.number(t)&&parseInt(t,10)===t},float:function(t){return ye.number(t)&&!ye.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!ye.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(wt.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(Wr())},hex:function(t){return typeof t=="string"&&!!t.match(wt.hex)}},Gr=function(t,e,r,n,a){if(t.required&&e===void 0){kt(t,e,r,n,a);return}var o=["integer","float","array","regexp","object","method","email","number","date","url","hex"],s=t.type;o.indexOf(s)>-1?ye[s](e)||n.push(J(a.messages.types[s],t.fullField,t.type)):s&&typeof e!==t.type&&n.push(J(a.messages.types[s],t.fullField,t.type))},Br=function(t,e,r,n,a){var o=typeof t.len=="number",s=typeof t.min=="number",u=typeof t.max=="number",l=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,c=e,f=null,v=typeof e=="number",E=typeof e=="string",F=Array.isArray(e);if(v?f="number":E?f="string":F&&(f="array"),!f)return!1;F&&(c=e.length),E&&(c=e.replace(l,"_").length),o?c!==t.len&&n.push(J(a.messages[f].len,t.fullField,t.len)):s&&!u&&c<t.min?n.push(J(a.messages[f].min,t.fullField,t.min)):u&&!s&&c>t.max?n.push(J(a.messages[f].max,t.fullField,t.max)):s&&u&&(c<t.min||c>t.max)&&n.push(J(a.messages[f].range,t.fullField,t.min,t.max))},de="enum",Hr=function(t,e,r,n,a){t[de]=Array.isArray(t[de])?t[de]:[],t[de].indexOf(e)===-1&&n.push(J(a.messages[de],t.fullField,t[de].join(", ")))},Yr=function(t,e,r,n,a){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(e)||n.push(J(a.messages.pattern.mismatch,t.fullField,e,t.pattern));else if(typeof t.pattern=="string"){var o=new RegExp(t.pattern);o.test(e)||n.push(J(a.messages.pattern.mismatch,t.fullField,e,t.pattern))}}},$={required:kt,whitespace:zr,type:Gr,range:Br,enum:Hr,pattern:Yr},Xr=function(t,e,r,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(X(e,"string")&&!t.required)return r();$.required(t,e,n,o,a,"string"),X(e,"string")||($.type(t,e,n,o,a),$.range(t,e,n,o,a),$.pattern(t,e,n,o,a),t.whitespace===!0&&$.whitespace(t,e,n,o,a))}r(o)},Kr=function(t,e,r,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(X(e)&&!t.required)return r();$.required(t,e,n,o,a),e!==void 0&&$.type(t,e,n,o,a)}r(o)},Qr=function(t,e,r,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(e===""&&(e=void 0),X(e)&&!t.required)return r();$.required(t,e,n,o,a),e!==void 0&&($.type(t,e,n,o,a),$.range(t,e,n,o,a))}r(o)},Zr=function(t,e,r,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(X(e)&&!t.required)return r();$.required(t,e,n,o,a),e!==void 0&&$.type(t,e,n,o,a)}r(o)},Jr=function(t,e,r,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(X(e)&&!t.required)return r();$.required(t,e,n,o,a),X(e)||$.type(t,e,n,o,a)}r(o)},en=function(t,e,r,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(X(e)&&!t.required)return r();$.required(t,e,n,o,a),e!==void 0&&($.type(t,e,n,o,a),$.range(t,e,n,o,a))}r(o)},tn=function(t,e,r,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(X(e)&&!t.required)return r();$.required(t,e,n,o,a),e!==void 0&&($.type(t,e,n,o,a),$.range(t,e,n,o,a))}r(o)},rn=function(t,e,r,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(e==null&&!t.required)return r();$.required(t,e,n,o,a,"array"),e!=null&&($.type(t,e,n,o,a),$.range(t,e,n,o,a))}r(o)},nn=function(t,e,r,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(X(e)&&!t.required)return r();$.required(t,e,n,o,a),e!==void 0&&$.type(t,e,n,o,a)}r(o)},an="enum",on=function(t,e,r,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(X(e)&&!t.required)return r();$.required(t,e,n,o,a),e!==void 0&&$[an](t,e,n,o,a)}r(o)},sn=function(t,e,r,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(X(e,"string")&&!t.required)return r();$.required(t,e,n,o,a),X(e,"string")||$.pattern(t,e,n,o,a)}r(o)},un=function(t,e,r,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(X(e,"date")&&!t.required)return r();if($.required(t,e,n,o,a),!X(e,"date")){var u;e instanceof Date?u=e:u=new Date(e),$.type(t,u,n,o,a),u&&$.range(t,u.getTime(),n,o,a)}}r(o)},ln=function(t,e,r,n,a){var o=[],s=Array.isArray(e)?"array":typeof e;$.required(t,e,n,o,a,s),r(o)},qe=function(t,e,r,n,a){var o=t.type,s=[],u=t.required||!t.required&&n.hasOwnProperty(t.field);if(u){if(X(e,o)&&!t.required)return r();$.required(t,e,n,s,a,o),X(e,o)||$.type(t,e,n,s,a)}r(s)},cn=function(t,e,r,n,a){var o=[],s=t.required||!t.required&&n.hasOwnProperty(t.field);if(s){if(X(e)&&!t.required)return r();$.required(t,e,n,o,a)}r(o)},be={string:Xr,method:Kr,number:Qr,boolean:Zr,regexp:Jr,integer:en,float:tn,array:rn,object:nn,enum:on,pattern:sn,date:un,url:qe,hex:qe,email:qe,required:ln,any:cn};function Ke(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var Qe=Ke(),Pe=function(){function i(e){this.rules=null,this._messages=Qe,this.define(e)}var t=i.prototype;return t.define=function(r){var n=this;if(!r)throw new Error("Cannot configure a schema with no rules");if(typeof r!="object"||Array.isArray(r))throw new Error("Rules must be an object");this.rules={},Object.keys(r).forEach(function(a){var o=r[a];n.rules[a]=Array.isArray(o)?o:[o]})},t.messages=function(r){return r&&(this._messages=bt(Ke(),r)),this._messages},t.validate=function(r,n,a){var o=this;n===void 0&&(n={}),a===void 0&&(a=function(){});var s=r,u=n,l=a;if(typeof u=="function"&&(l=u,u={}),!this.rules||Object.keys(this.rules).length===0)return l&&l(null,s),Promise.resolve(s);function c(h){var p=[],d={};function w(V){if(Array.isArray(V)){var R;p=(R=p).concat.apply(R,V)}else p.push(V)}for(var m=0;m<h.length;m++)w(h[m]);p.length?(d=Xe(p),l(p,d)):l(null,s)}if(u.messages){var f=this.messages();f===Qe&&(f=Ke()),bt(f,u.messages),u.messages=f}else u.messages=this.messages();var v={},E=u.keys||Object.keys(this.rules);E.forEach(function(h){var p=o.rules[h],d=s[h];p.forEach(function(w){var m=w;typeof m.transform=="function"&&(s===r&&(s=fe({},s)),d=s[h]=m.transform(d)),typeof m=="function"?m={validator:m}:m=fe({},m),m.validator=o.getValidationMethod(m),m.validator&&(m.field=h,m.fullField=m.fullField||h,m.type=o.getType(m),v[h]=v[h]||[],v[h].push({rule:m,value:d,source:s,field:h}))})});var F={};return Ir(v,u,function(h,p){var d=h.rule,w=(d.type==="object"||d.type==="array")&&(typeof d.fields=="object"||typeof d.defaultField=="object");w=w&&(d.required||!d.required&&h.value),d.field=h.field;function m(C,O){return fe({},O,{fullField:d.fullField+"."+C,fullFields:d.fullFields?[].concat(d.fullFields,[C]):[C]})}function V(C){C===void 0&&(C=[]);var O=Array.isArray(C)?C:[C];!u.suppressWarning&&O.length&&i.warning("async-validator:",O),O.length&&d.message!==void 0&&(O=[].concat(d.message));var M=O.map(yt(d,s));if(u.first&&M.length)return F[d.field]=1,p(M);if(!w)p(M);else{if(d.required&&!h.value)return d.message!==void 0?M=[].concat(d.message).map(yt(d,s)):u.error&&(M=[u.error(d,J(u.messages.required,d.field))]),p(M);var S={};d.defaultField&&Object.keys(h.value).map(function(k){S[k]=d.defaultField}),S=fe({},S,h.rule.fields);var A={};Object.keys(S).forEach(function(k){var T=S[k],G=Array.isArray(T)?T:[T];A[k]=G.map(m.bind(null,k))});var j=new i(A);j.messages(u.messages),h.rule.options&&(h.rule.options.messages=u.messages,h.rule.options.error=u.error),j.validate(h.value,h.rule.options||u,function(k){var T=[];M&&M.length&&T.push.apply(T,M),k&&k.length&&T.push.apply(T,k),p(T.length?T:null)})}}var R;if(d.asyncValidator)R=d.asyncValidator(d,h.value,V,h.source,u);else if(d.validator){try{R=d.validator(d,h.value,V,h.source,u)}catch(C){console.error==null||console.error(C),u.suppressValidatorError||setTimeout(function(){throw C},0),V(C.message)}R===!0?V():R===!1?V(typeof d.message=="function"?d.message(d.fullField||d.field):d.message||(d.fullField||d.field)+" fails"):R instanceof Array?V(R):R instanceof Error&&V(R.message)}R&&R.then&&R.then(function(){return V()},function(C){return V(C)})},function(h){c(h)},s)},t.getType=function(r){if(r.type===void 0&&r.pattern instanceof RegExp&&(r.type="pattern"),typeof r.validator!="function"&&r.type&&!be.hasOwnProperty(r.type))throw new Error(J("Unknown rule type %s",r.type));return r.type||"string"},t.getValidationMethod=function(r){if(typeof r.validator=="function")return r.validator;var n=Object.keys(r),a=n.indexOf("message");return a!==-1&&n.splice(a,1),n.length===1&&n[0]==="required"?be.required:be[this.getType(r)]||void 0},i}();Pe.register=function(t,e){if(typeof e!="function")throw new Error("Cannot register a validator by type, validator is not a function");be[t]=e};Pe.warning=Tr;Pe.messages=Qe;Pe.validators=be;var Z="'${name}' is not a valid ${type}",Nt={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:Z,method:Z,array:Z,object:Z,number:Z,date:Z,boolean:Z,integer:Z,float:Z,regexp:Z,email:Z,url:Z,hex:Z},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},Ft=Pe;function fn(i,t){return i.replace(/\$\{\w+\}/g,function(e){var r=e.slice(2,-1);return t[r]})}var xt="CODE_LOGIC_ERROR";function Ze(i,t,e,r,n){return Je.apply(this,arguments)}function Je(){return Je=xe(ne().mark(function i(t,e,r,n,a){var o,s,u,l,c,f,v,E,F;return ne().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return o=I({},r),delete o.ruleIndex,Ft.warning=function(){},o.validator&&(s=o.validator,o.validator=function(){try{return s.apply(void 0,arguments)}catch(d){return console.error(d),Promise.reject(xt)}}),u=null,o&&o.type==="array"&&o.defaultField&&(u=o.defaultField,delete o.defaultField),l=new Ft(y({},t,[o])),c=me(Nt,n.validateMessages),l.messages(c),f=[],p.prev=10,p.next=13,Promise.resolve(l.validate(y({},t,e),I({},n)));case 13:p.next=18;break;case 15:p.prev=15,p.t0=p.catch(10),p.t0.errors&&(f=p.t0.errors.map(function(d,w){var m=d.message,V=m===xt?c.default:m;return x.exports.isValidElement(V)?x.exports.cloneElement(V,{key:"error_".concat(w)}):V}));case 18:if(!(!f.length&&u)){p.next=23;break}return p.next=21,Promise.all(e.map(function(d,w){return Ze("".concat(t,".").concat(w),d,u,n,a)}));case 21:return v=p.sent,p.abrupt("return",v.reduce(function(d,w){return[].concat(U(d),U(w))},[]));case 23:return E=I(I({},r),{},{name:t,enum:(r.enum||[]).join(", ")},a),F=f.map(function(d){return typeof d=="string"?fn(d,E):d}),p.abrupt("return",F);case 26:case"end":return p.stop()}},i,null,[[10,15]])})),Je.apply(this,arguments)}function dn(i,t,e,r,n,a){var o=i.join("."),s=e.map(function(c,f){var v=c.validator,E=I(I({},c),{},{ruleIndex:f});return v&&(E.validator=function(F,h,p){var d=!1,w=function(){for(var R=arguments.length,C=new Array(R),O=0;O<R;O++)C[O]=arguments[O];Promise.resolve().then(function(){ue(!d,"Your validator function has already return a promise. `callback` will be ignored."),d||p.apply(void 0,C)})},m=v(F,h,w);d=m&&typeof m.then=="function"&&typeof m.catch=="function",ue(d,"`callback` is deprecated. Please return a promise instead."),d&&m.then(function(){p()}).catch(function(V){p(V||" ")})}),E}).sort(function(c,f){var v=c.warningOnly,E=c.ruleIndex,F=f.warningOnly,h=f.ruleIndex;return!!v==!!F?E-h:v?1:-1}),u;if(n===!0)u=new Promise(function(){var c=xe(ne().mark(function f(v,E){var F,h,p;return ne().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:F=0;case 1:if(!(F<s.length)){w.next=12;break}return h=s[F],w.next=5,Ze(o,t,h,r,a);case 5:if(p=w.sent,!p.length){w.next=9;break}return E([{errors:p,rule:h}]),w.abrupt("return");case 9:F+=1,w.next=1;break;case 12:v([]);case 13:case"end":return w.stop()}},f)}));return function(f,v){return c.apply(this,arguments)}}());else{var l=s.map(function(c){return Ze(o,t,c,r,a).then(function(f){return{errors:f,rule:c}})});u=(n?vn(l):hn(l)).then(function(c){return Promise.reject(c)})}return u.catch(function(c){return c}),u}function hn(i){return et.apply(this,arguments)}function et(){return et=xe(ne().mark(function i(t){return ne().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Promise.all(t).then(function(n){var a,o=(a=[]).concat.apply(a,U(n));return o}));case 1:case"end":return r.stop()}},i)})),et.apply(this,arguments)}function vn(i){return tt.apply(this,arguments)}function tt(){return tt=xe(ne().mark(function i(t){var e;return ne().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=0,n.abrupt("return",new Promise(function(a){t.forEach(function(o){o.then(function(s){s.errors.length&&a([s]),e+=1,e===t.length&&a([])})})}));case 2:case"end":return n.stop()}},i)})),tt.apply(this,arguments)}function Y(i){return Be(i)}function Pt(i,t){var e={};return t.forEach(function(r){var n=se(i,r);e=oe(e,r,n)}),e}function pe(i,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return i&&i.some(function(r){return jt(t,r,e)})}function jt(i,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return!i||!t||!e&&i.length!==t.length?!1:t.every(function(r,n){return i[n]===r})}function pn(i,t){if(i===t)return!0;if(!i&&t||i&&!t||!i||!t||ee(i)!=="object"||ee(t)!=="object")return!1;var e=Object.keys(i),r=Object.keys(t),n=new Set([].concat(e,r));return U(n).every(function(a){var o=i[a],s=t[a];return typeof o=="function"&&typeof s=="function"?!0:o===s})}function gn(i){var t=arguments.length<=1?void 0:arguments[1];return t&&t.target&&ee(t.target)==="object"&&i in t.target?t.target[i]:t}function Et(i,t,e){var r=i.length;if(t<0||t>=r||e<0||e>=r)return i;var n=i[t],a=t-e;return a>0?[].concat(U(i.slice(0,e)),[n],U(i.slice(e,t)),U(i.slice(t+1,r))):a<0?[].concat(U(i.slice(0,t)),U(i.slice(t+1,e+1)),[n],U(i.slice(e+1,r))):i}var mn=["name"],re=[];function Ct(i,t,e,r,n,a){return typeof i=="function"?i(t,e,"source"in a?{source:a.source}:{}):r!==n}var st=function(i){Vr(e,i);var t=Ar(e);function e(r){var n;if(at(this,e),n=t.call(this,r),y(q(n),"state",{resetCount:0}),y(q(n),"cancelRegisterFunc",null),y(q(n),"mounted",!1),y(q(n),"touched",!1),y(q(n),"dirty",!1),y(q(n),"validatePromise",void 0),y(q(n),"prevValidating",void 0),y(q(n),"errors",re),y(q(n),"warnings",re),y(q(n),"cancelRegister",function(){var u=n.props,l=u.preserve,c=u.isListField,f=u.name;n.cancelRegisterFunc&&n.cancelRegisterFunc(c,l,Y(f)),n.cancelRegisterFunc=null}),y(q(n),"getNamePath",function(){var u=n.props,l=u.name,c=u.fieldContext,f=c.prefixName,v=f===void 0?[]:f;return l!==void 0?[].concat(U(v),U(l)):[]}),y(q(n),"getRules",function(){var u=n.props,l=u.rules,c=l===void 0?[]:l,f=u.fieldContext;return c.map(function(v){return typeof v=="function"?v(f):v})}),y(q(n),"refresh",function(){!n.mounted||n.setState(function(u){var l=u.resetCount;return{resetCount:l+1}})}),y(q(n),"metaCache",null),y(q(n),"triggerMetaEvent",function(u){var l=n.props.onMetaChange;if(l){var c=I(I({},n.getMeta()),{},{destroy:u});Wt(n.metaCache,c)||l(c),n.metaCache=c}else n.metaCache=null}),y(q(n),"onStoreChange",function(u,l,c){var f=n.props,v=f.shouldUpdate,E=f.dependencies,F=E===void 0?[]:E,h=f.onReset,p=c.store,d=n.getNamePath(),w=n.getValue(u),m=n.getValue(p),V=l&&pe(l,d);switch(c.type==="valueUpdate"&&c.source==="external"&&w!==m&&(n.touched=!0,n.dirty=!0,n.validatePromise=null,n.errors=re,n.warnings=re,n.triggerMetaEvent()),c.type){case"reset":if(!l||V){n.touched=!1,n.dirty=!1,n.validatePromise=void 0,n.errors=re,n.warnings=re,n.triggerMetaEvent(),h==null||h(),n.refresh();return}break;case"remove":{if(v){n.reRender();return}break}case"setField":{var R=c.data;if(V){"touched"in R&&(n.touched=R.touched),"validating"in R&&!("originRCField"in R)&&(n.validatePromise=R.validating?Promise.resolve([]):null),"errors"in R&&(n.errors=R.errors||re),"warnings"in R&&(n.warnings=R.warnings||re),n.dirty=!0,n.triggerMetaEvent(),n.reRender();return}else if("value"in R&&pe(l,d,!0)){n.reRender();return}if(v&&!d.length&&Ct(v,u,p,w,m,c)){n.reRender();return}break}case"dependenciesUpdate":{var C=F.map(Y);if(C.some(function(O){return pe(c.relatedFields,O)})){n.reRender();return}break}default:if(V||(!F.length||d.length||v)&&Ct(v,u,p,w,m,c)){n.reRender();return}break}v===!0&&n.reRender()}),y(q(n),"validateRules",function(u){var l=n.getNamePath(),c=n.getValue(),f=u||{},v=f.triggerName,E=f.validateOnly,F=E===void 0?!1:E,h=Promise.resolve().then(xe(ne().mark(function p(){var d,w,m,V,R,C,O;return ne().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(n.mounted){S.next=2;break}return S.abrupt("return",[]);case 2:if(d=n.props,w=d.validateFirst,m=w===void 0?!1:w,V=d.messageVariables,R=d.validateDebounce,C=n.getRules(),v&&(C=C.filter(function(A){return A}).filter(function(A){var j=A.validateTrigger;if(!j)return!0;var k=Be(j);return k.includes(v)})),!(R&&v)){S.next=10;break}return S.next=8,new Promise(function(A){setTimeout(A,R)});case 8:if(n.validatePromise===h){S.next=10;break}return S.abrupt("return",[]);case 10:return O=dn(l,c,C,u,m,V),O.catch(function(A){return A}).then(function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:re;if(n.validatePromise===h){var j;n.validatePromise=null;var k=[],T=[];(j=A.forEach)===null||j===void 0||j.call(A,function(G){var z=G.rule.warningOnly,P=G.errors,g=P===void 0?re:P;z?T.push.apply(T,U(g)):k.push.apply(k,U(g))}),n.errors=k,n.warnings=T,n.triggerMetaEvent(),n.reRender()}}),S.abrupt("return",O);case 13:case"end":return S.stop()}},p)})));return F||(n.validatePromise=h,n.dirty=!0,n.errors=re,n.warnings=re,n.triggerMetaEvent(),n.reRender()),h}),y(q(n),"isFieldValidating",function(){return!!n.validatePromise}),y(q(n),"isFieldTouched",function(){return n.touched}),y(q(n),"isFieldDirty",function(){if(n.dirty||n.props.initialValue!==void 0)return!0;var u=n.props.fieldContext,l=u.getInternalHooks(ce),c=l.getInitialValue;return c(n.getNamePath())!==void 0}),y(q(n),"getErrors",function(){return n.errors}),y(q(n),"getWarnings",function(){return n.warnings}),y(q(n),"isListField",function(){return n.props.isListField}),y(q(n),"isList",function(){return n.props.isList}),y(q(n),"isPreserve",function(){return n.props.preserve}),y(q(n),"getMeta",function(){n.prevValidating=n.isFieldValidating();var u={touched:n.isFieldTouched(),validating:n.prevValidating,errors:n.errors,warnings:n.warnings,name:n.getNamePath(),validated:n.validatePromise===null};return u}),y(q(n),"getOnlyChild",function(u){if(typeof u=="function"){var l=n.getMeta();return I(I({},n.getOnlyChild(u(n.getControlled(),l,n.props.fieldContext))),{},{isFunction:!0})}var c=Gt(u);return c.length!==1||!x.exports.isValidElement(c[0])?{child:c,isFunction:!1}:{child:c[0],isFunction:!1}}),y(q(n),"getValue",function(u){var l=n.props.fieldContext.getFieldsValue,c=n.getNamePath();return se(u||l(!0),c)}),y(q(n),"getControlled",function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=n.props,c=l.trigger,f=l.validateTrigger,v=l.getValueFromEvent,E=l.normalize,F=l.valuePropName,h=l.getValueProps,p=l.fieldContext,d=f!==void 0?f:p.validateTrigger,w=n.getNamePath(),m=p.getInternalHooks,V=p.getFieldsValue,R=m(ce),C=R.dispatch,O=n.getValue(),M=h||function(k){return y({},F,k)},S=u[c],A=I(I({},u),M(O));A[c]=function(){n.touched=!0,n.dirty=!0,n.triggerMetaEvent();for(var k,T=arguments.length,G=new Array(T),z=0;z<T;z++)G[z]=arguments[z];v?k=v.apply(void 0,G):k=gn.apply(void 0,[F].concat(G)),E&&(k=E(k,O,V(!0))),C({type:"updateValue",namePath:w,value:k}),S&&S.apply(void 0,G)};var j=Be(d||[]);return j.forEach(function(k){var T=A[k];A[k]=function(){T&&T.apply(void 0,arguments);var G=n.props.rules;G&&G.length&&C({type:"validateField",namePath:w,triggerName:k})}}),A}),r.fieldContext){var a=r.fieldContext.getInternalHooks,o=a(ce),s=o.initEntityValue;s(q(n))}return n}return ot(e,[{key:"componentDidMount",value:function(){var n=this.props,a=n.shouldUpdate,o=n.fieldContext;if(this.mounted=!0,o){var s=o.getInternalHooks,u=s(ce),l=u.registerField;this.cancelRegisterFunc=l(this)}a===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){!this.mounted||this.forceUpdate()}},{key:"render",value:function(){var n=this.state.resetCount,a=this.props.children,o=this.getOnlyChild(a),s=o.child,u=o.isFunction,l;return u?l=s:x.exports.isValidElement(s)?l=x.exports.cloneElement(s,this.getControlled(s.props)):(ue(!s,"`children` of Field is not validate ReactElement."),l=s),x.exports.createElement(x.exports.Fragment,{key:n},l)}}]),e}(x.exports.Component);y(st,"contextType",ge);y(st,"defaultProps",{trigger:"onChange",valuePropName:"value"});function Tt(i){var t=i.name,e=it(i,mn),r=x.exports.useContext(ge),n=x.exports.useContext(ke),a=t!==void 0?Y(t):void 0,o="keep";return e.isListField||(o="_".concat((a||[]).join("_"))),x.exports.createElement(st,Le({key:o,name:a,isListField:!!n},e,{fieldContext:r}))}function yn(i){var t=i.name,e=i.initialValue,r=i.children,n=i.rules,a=i.validateTrigger,o=i.isListField,s=x.exports.useContext(ge),u=x.exports.useContext(ke),l=x.exports.useRef({keys:[],id:0}),c=l.current,f=x.exports.useMemo(function(){var h=Y(s.prefixName)||[];return[].concat(U(h),U(Y(t)))},[s.prefixName,t]),v=x.exports.useMemo(function(){return I(I({},s),{},{prefixName:f})},[s,f]),E=x.exports.useMemo(function(){return{getKey:function(p){var d=f.length,w=p[d];return[c.keys[w],p.slice(d+1)]}}},[f]);if(typeof r!="function")return ue(!1,"Form.List only accepts function as children."),null;var F=function(p,d,w){var m=w.source;return m==="internal"?!1:p!==d};return x.exports.createElement(ke.Provider,{value:E},x.exports.createElement(ge.Provider,{value:v},x.exports.createElement(Tt,{name:[],shouldUpdate:F,rules:n,validateTrigger:a,initialValue:e,isList:!0,isListField:o!=null?o:!!u},function(h,p){var d=h.value,w=d===void 0?[]:d,m=h.onChange,V=s.getFieldValue,R=function(){var S=V(f||[]);return S||[]},C={add:function(S,A){var j=R();A>=0&&A<=j.length?(c.keys=[].concat(U(c.keys.slice(0,A)),[c.id],U(c.keys.slice(A))),m([].concat(U(j.slice(0,A)),[S],U(j.slice(A))))):(c.keys=[].concat(U(c.keys),[c.id]),m([].concat(U(j),[S]))),c.id+=1},remove:function(S){var A=R(),j=new Set(Array.isArray(S)?S:[S]);j.size<=0||(c.keys=c.keys.filter(function(k,T){return!j.has(T)}),m(A.filter(function(k,T){return!j.has(T)})))},move:function(S,A){if(S!==A){var j=R();S<0||S>=j.length||A<0||A>=j.length||(c.keys=Et(c.keys,S,A),m(Et(j,S,A)))}}},O=w||[];return Array.isArray(O)||(O=[]),r(O.map(function(M,S){var A=c.keys[S];return A===void 0&&(c.keys[S]=c.id,A=c.keys[S],c.id+=1),{name:S,key:A,isListField:!0}}),C,p)})))}function bn(i){if(Array.isArray(i))return i}function wn(i,t){var e=i==null?null:typeof Symbol!="undefined"&&i[Symbol.iterator]||i["@@iterator"];if(e!=null){var r,n,a,o,s=[],u=!0,l=!1;try{if(a=(e=e.call(i)).next,t===0){if(Object(e)!==e)return;u=!1}else for(;!(u=(r=a.call(e)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(c){l=!0,n=c}finally{try{if(!u&&e.return!=null&&(o=e.return(),Object(o)!==o))return}finally{if(l)throw n}}return s}}function Fn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fe(i,t){return bn(i)||wn(i,t)||_t(i,t)||Fn()}function xn(i){var t=!1,e=i.length,r=[];return i.length?new Promise(function(n,a){i.forEach(function(o,s){o.catch(function(u){return t=!0,u}).then(function(u){e-=1,r[s]=u,!(e>0)&&(t&&a(r),n(r))})})}):Promise.resolve([])}var Mt="__@field_split__";function Ue(i){return i.map(function(t){return"".concat(ee(t),":").concat(t)}).join(Mt)}var he=function(){function i(){at(this,i),y(this,"kvs",new Map)}return ot(i,[{key:"set",value:function(e,r){this.kvs.set(Ue(e),r)}},{key:"get",value:function(e){return this.kvs.get(Ue(e))}},{key:"update",value:function(e,r){var n=this.get(e),a=r(n);a?this.set(e,a):this.delete(e)}},{key:"delete",value:function(e){this.kvs.delete(Ue(e))}},{key:"map",value:function(e){return U(this.kvs.entries()).map(function(r){var n=Fe(r,2),a=n[0],o=n[1],s=a.split(Mt);return e({key:s.map(function(u){var l=u.match(/^([^:]*):(.*)$/),c=Fe(l,3),f=c[1],v=c[2];return f==="number"?Number(v):v}),value:o})})}},{key:"toJSON",value:function(){var e={};return this.map(function(r){var n=r.key,a=r.value;return e[n.join(".")]=a,null}),e}}]),i}(),Pn=["name"],En=ot(function i(t){var e=this;at(this,i),y(this,"formHooked",!1),y(this,"forceRootUpdate",void 0),y(this,"subscribable",!0),y(this,"store",{}),y(this,"fieldEntities",[]),y(this,"initialValues",{}),y(this,"callbacks",{}),y(this,"validateMessages",null),y(this,"preserve",null),y(this,"lastValidatePromise",null),y(this,"getForm",function(){return{getFieldValue:e.getFieldValue,getFieldsValue:e.getFieldsValue,getFieldError:e.getFieldError,getFieldWarning:e.getFieldWarning,getFieldsError:e.getFieldsError,isFieldsTouched:e.isFieldsTouched,isFieldTouched:e.isFieldTouched,isFieldValidating:e.isFieldValidating,isFieldsValidating:e.isFieldsValidating,resetFields:e.resetFields,setFields:e.setFields,setFieldValue:e.setFieldValue,setFieldsValue:e.setFieldsValue,validateFields:e.validateFields,submit:e.submit,_init:!0,getInternalHooks:e.getInternalHooks}}),y(this,"getInternalHooks",function(r){return r===ce?(e.formHooked=!0,{dispatch:e.dispatch,initEntityValue:e.initEntityValue,registerField:e.registerField,useSubscribe:e.useSubscribe,setInitialValues:e.setInitialValues,destroyForm:e.destroyForm,setCallbacks:e.setCallbacks,setValidateMessages:e.setValidateMessages,getFields:e.getFields,setPreserve:e.setPreserve,getInitialValue:e.getInitialValue,registerWatch:e.registerWatch}):(ue(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)}),y(this,"useSubscribe",function(r){e.subscribable=r}),y(this,"prevWithoutPreserves",null),y(this,"setInitialValues",function(r,n){if(e.initialValues=r||{},n){var a,o=me(r,e.store);(a=e.prevWithoutPreserves)===null||a===void 0||a.map(function(s){var u=s.key;o=oe(o,u,se(r,u))}),e.prevWithoutPreserves=null,e.updateStore(o)}}),y(this,"destroyForm",function(){var r=new he;e.getFieldEntities(!0).forEach(function(n){e.isMergedPreserve(n.isPreserve())||r.set(n.getNamePath(),!0)}),e.prevWithoutPreserves=r}),y(this,"getInitialValue",function(r){var n=se(e.initialValues,r);return r.length?me(n):n}),y(this,"setCallbacks",function(r){e.callbacks=r}),y(this,"setValidateMessages",function(r){e.validateMessages=r}),y(this,"setPreserve",function(r){e.preserve=r}),y(this,"watchList",[]),y(this,"registerWatch",function(r){return e.watchList.push(r),function(){e.watchList=e.watchList.filter(function(n){return n!==r})}}),y(this,"notifyWatch",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(e.watchList.length){var n=e.getFieldsValue(),a=e.getFieldsValue(!0);e.watchList.forEach(function(o){o(n,a,r)})}}),y(this,"timeoutId",null),y(this,"warningUnhooked",function(){}),y(this,"updateStore",function(r){e.store=r}),y(this,"getFieldEntities",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return r?e.fieldEntities.filter(function(n){return n.getNamePath().length}):e.fieldEntities}),y(this,"getFieldsMap",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=new he;return e.getFieldEntities(r).forEach(function(a){var o=a.getNamePath();n.set(o,a)}),n}),y(this,"getFieldEntitiesForNamePathList",function(r){if(!r)return e.getFieldEntities(!0);var n=e.getFieldsMap(!0);return r.map(function(a){var o=Y(a);return n.get(o)||{INVALIDATE_NAME_PATH:Y(a)}})}),y(this,"getFieldsValue",function(r,n){e.warningUnhooked();var a,o,s;if(r===!0||Array.isArray(r)?(a=r,o=n):r&&ee(r)==="object"&&(s=r.strict,o=r.filter),a===!0&&!o)return e.store;var u=e.getFieldEntitiesForNamePathList(Array.isArray(a)?a:null),l=[];return u.forEach(function(c){var f,v,E="INVALIDATE_NAME_PATH"in c?c.INVALIDATE_NAME_PATH:c.getNamePath();if(s){var F,h;if((F=(h=c).isList)!==null&&F!==void 0&&F.call(h))return}else if(!a&&(f=(v=c).isListField)!==null&&f!==void 0&&f.call(v))return;if(!o)l.push(E);else{var p="getMeta"in c?c.getMeta():null;o(p)&&l.push(E)}}),Pt(e.store,l.map(Y))}),y(this,"getFieldValue",function(r){e.warningUnhooked();var n=Y(r);return se(e.store,n)}),y(this,"getFieldsError",function(r){e.warningUnhooked();var n=e.getFieldEntitiesForNamePathList(r);return n.map(function(a,o){return a&&!("INVALIDATE_NAME_PATH"in a)?{name:a.getNamePath(),errors:a.getErrors(),warnings:a.getWarnings()}:{name:Y(r[o]),errors:[],warnings:[]}})}),y(this,"getFieldError",function(r){e.warningUnhooked();var n=Y(r),a=e.getFieldsError([n])[0];return a.errors}),y(this,"getFieldWarning",function(r){e.warningUnhooked();var n=Y(r),a=e.getFieldsError([n])[0];return a.warnings}),y(this,"isFieldsTouched",function(){e.warningUnhooked();for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var o=n[0],s=n[1],u,l=!1;n.length===0?u=null:n.length===1?Array.isArray(o)?(u=o.map(Y),l=!1):(u=null,l=o):(u=o.map(Y),l=s);var c=e.getFieldEntities(!0),f=function(p){return p.isFieldTouched()};if(!u)return l?c.every(f):c.some(f);var v=new he;u.forEach(function(h){v.set(h,[])}),c.forEach(function(h){var p=h.getNamePath();u.forEach(function(d){d.every(function(w,m){return p[m]===w})&&v.update(d,function(w){return[].concat(U(w),[h])})})});var E=function(p){return p.some(f)},F=v.map(function(h){var p=h.value;return p});return l?F.every(E):F.some(E)}),y(this,"isFieldTouched",function(r){return e.warningUnhooked(),e.isFieldsTouched([r])}),y(this,"isFieldsValidating",function(r){e.warningUnhooked();var n=e.getFieldEntities();if(!r)return n.some(function(o){return o.isFieldValidating()});var a=r.map(Y);return n.some(function(o){var s=o.getNamePath();return pe(a,s)&&o.isFieldValidating()})}),y(this,"isFieldValidating",function(r){return e.warningUnhooked(),e.isFieldsValidating([r])}),y(this,"resetWithFieldInitialValue",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=new he,a=e.getFieldEntities(!0);a.forEach(function(u){var l=u.props.initialValue,c=u.getNamePath();if(l!==void 0){var f=n.get(c)||new Set;f.add({entity:u,value:l}),n.set(c,f)}});var o=function(l){l.forEach(function(c){var f=c.props.initialValue;if(f!==void 0){var v=c.getNamePath(),E=e.getInitialValue(v);if(E!==void 0)ue(!1,"Form already set 'initialValues' with path '".concat(v.join("."),"'. Field can not overwrite it."));else{var F=n.get(v);if(F&&F.size>1)ue(!1,"Multiple Field with path '".concat(v.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(F){var h=e.getFieldValue(v);(!r.skipExist||h===void 0)&&e.updateStore(oe(e.store,v,U(F)[0].value))}}}})},s;r.entities?s=r.entities:r.namePathList?(s=[],r.namePathList.forEach(function(u){var l=n.get(u);if(l){var c;(c=s).push.apply(c,U(U(l).map(function(f){return f.entity})))}})):s=a,o(s)}),y(this,"resetFields",function(r){e.warningUnhooked();var n=e.store;if(!r){e.updateStore(me(e.initialValues)),e.resetWithFieldInitialValue(),e.notifyObservers(n,null,{type:"reset"}),e.notifyWatch();return}var a=r.map(Y);a.forEach(function(o){var s=e.getInitialValue(o);e.updateStore(oe(e.store,o,s))}),e.resetWithFieldInitialValue({namePathList:a}),e.notifyObservers(n,a,{type:"reset"}),e.notifyWatch(a)}),y(this,"setFields",function(r){e.warningUnhooked();var n=e.store,a=[];r.forEach(function(o){var s=o.name,u=it(o,Pn),l=Y(s);a.push(l),"value"in u&&e.updateStore(oe(e.store,l,u.value)),e.notifyObservers(n,[l],{type:"setField",data:o})}),e.notifyWatch(a)}),y(this,"getFields",function(){var r=e.getFieldEntities(!0),n=r.map(function(a){var o=a.getNamePath(),s=a.getMeta(),u=I(I({},s),{},{name:o,value:e.getFieldValue(o)});return Object.defineProperty(u,"originRCField",{value:!0}),u});return n}),y(this,"initEntityValue",function(r){var n=r.props.initialValue;if(n!==void 0){var a=r.getNamePath(),o=se(e.store,a);o===void 0&&e.updateStore(oe(e.store,a,n))}}),y(this,"isMergedPreserve",function(r){var n=r!==void 0?r:e.preserve;return n!=null?n:!0}),y(this,"registerField",function(r){e.fieldEntities.push(r);var n=r.getNamePath();if(e.notifyWatch([n]),r.props.initialValue!==void 0){var a=e.store;e.resetWithFieldInitialValue({entities:[r],skipExist:!0}),e.notifyObservers(a,[r.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(o,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(e.fieldEntities=e.fieldEntities.filter(function(f){return f!==r}),!e.isMergedPreserve(s)&&(!o||u.length>1)){var l=o?void 0:e.getInitialValue(n);if(n.length&&e.getFieldValue(n)!==l&&e.fieldEntities.every(function(f){return!jt(f.getNamePath(),n)})){var c=e.store;e.updateStore(oe(c,n,l,!0)),e.notifyObservers(c,[n],{type:"remove"}),e.triggerDependenciesUpdate(c,n)}}e.notifyWatch([n])}}),y(this,"dispatch",function(r){switch(r.type){case"updateValue":{var n=r.namePath,a=r.value;e.updateValue(n,a);break}case"validateField":{var o=r.namePath,s=r.triggerName;e.validateFields([o],{triggerName:s});break}}}),y(this,"notifyObservers",function(r,n,a){if(e.subscribable){var o=I(I({},a),{},{store:e.getFieldsValue(!0)});e.getFieldEntities().forEach(function(s){var u=s.onStoreChange;u(r,n,o)})}else e.forceRootUpdate()}),y(this,"triggerDependenciesUpdate",function(r,n){var a=e.getDependencyChildrenFields(n);return a.length&&e.validateFields(a),e.notifyObservers(r,a,{type:"dependenciesUpdate",relatedFields:[n].concat(U(a))}),a}),y(this,"updateValue",function(r,n){var a=Y(r),o=e.store;e.updateStore(oe(e.store,a,n)),e.notifyObservers(o,[a],{type:"valueUpdate",source:"internal"}),e.notifyWatch([a]);var s=e.triggerDependenciesUpdate(o,a),u=e.callbacks.onValuesChange;if(u){var l=Pt(e.store,[a]);u(l,e.getFieldsValue())}e.triggerOnFieldsChange([a].concat(U(s)))}),y(this,"setFieldsValue",function(r){e.warningUnhooked();var n=e.store;if(r){var a=me(e.store,r);e.updateStore(a)}e.notifyObservers(n,null,{type:"valueUpdate",source:"external"}),e.notifyWatch()}),y(this,"setFieldValue",function(r,n){e.setFields([{name:r,value:n}])}),y(this,"getDependencyChildrenFields",function(r){var n=new Set,a=[],o=new he;e.getFieldEntities().forEach(function(u){var l=u.props.dependencies;(l||[]).forEach(function(c){var f=Y(c);o.update(f,function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return v.add(u),v})})});var s=function u(l){var c=o.get(l)||new Set;c.forEach(function(f){if(!n.has(f)){n.add(f);var v=f.getNamePath();f.isFieldDirty()&&v.length&&(a.push(v),u(v))}})};return s(r),a}),y(this,"triggerOnFieldsChange",function(r,n){var a=e.callbacks.onFieldsChange;if(a){var o=e.getFields();if(n){var s=new he;n.forEach(function(l){var c=l.name,f=l.errors;s.set(c,f)}),o.forEach(function(l){l.errors=s.get(l.name)||l.errors})}var u=o.filter(function(l){var c=l.name;return pe(r,c)});u.length&&a(u,o)}}),y(this,"validateFields",function(r,n){var a;e.warningUnhooked();var o,s;Array.isArray(r)||typeof r=="string"||typeof n=="string"?(o=r,s=n):s=r;var u=!!o,l=u?o.map(Y):[],c=[],f=String(Date.now()),v=new Set,E=(a=s)===null||a===void 0?void 0:a.recursive;e.getFieldEntities(!0).forEach(function(d){if(u||l.push(d.getNamePath()),!(!d.props.rules||!d.props.rules.length)){var w=d.getNamePath();if(v.add(w.join(f)),!u||pe(l,w,E)){var m=d.validateRules(I({validateMessages:I(I({},Nt),e.validateMessages)},s));c.push(m.then(function(){return{name:w,errors:[],warnings:[]}}).catch(function(V){var R,C=[],O=[];return(R=V.forEach)===null||R===void 0||R.call(V,function(M){var S=M.rule.warningOnly,A=M.errors;S?O.push.apply(O,U(A)):C.push.apply(C,U(A))}),C.length?Promise.reject({name:w,errors:C,warnings:O}):{name:w,errors:C,warnings:O}}))}}});var F=xn(c);e.lastValidatePromise=F,F.catch(function(d){return d}).then(function(d){var w=d.map(function(m){var V=m.name;return V});e.notifyObservers(e.store,w,{type:"validateFinish"}),e.triggerOnFieldsChange(w,d)});var h=F.then(function(){return e.lastValidatePromise===F?Promise.resolve(e.getFieldsValue(l)):Promise.reject([])}).catch(function(d){var w=d.filter(function(m){return m&&m.errors.length});return Promise.reject({values:e.getFieldsValue(l),errorFields:w,outOfDate:e.lastValidatePromise!==F})});h.catch(function(d){return d});var p=l.filter(function(d){return v.has(d.join(f))});return e.triggerOnFieldsChange(p),h}),y(this,"submit",function(){e.warningUnhooked(),e.validateFields().then(function(r){var n=e.callbacks.onFinish;if(n)try{n(r)}catch(a){console.error(a)}}).catch(function(r){var n=e.callbacks.onFinishFailed;n&&n(r)})}),this.forceRootUpdate=t});function $t(i){var t=x.exports.useRef(),e=x.exports.useState({}),r=Fe(e,2),n=r[1];if(!t.current)if(i)t.current=i;else{var a=function(){n({})},o=new En(a);t.current=o.getForm()}return[t.current]}var rt=x.exports.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),Cn=function(t){var e=t.validateMessages,r=t.onFormChange,n=t.onFormFinish,a=t.children,o=x.exports.useContext(rt),s=x.exports.useRef({});return x.exports.createElement(rt.Provider,{value:I(I({},o),{},{validateMessages:I(I({},o.validateMessages),e),triggerFormChange:function(l,c){r&&r(l,{changedFields:c,forms:s.current}),o.triggerFormChange(l,c)},triggerFormFinish:function(l,c){n&&n(l,{values:c,forms:s.current}),o.triggerFormFinish(l,c)},registerForm:function(l,c){l&&(s.current=I(I({},s.current),{},y({},l,c))),o.registerForm(l,c)},unregisterForm:function(l){var c=I({},s.current);delete c[l],s.current=c,o.unregisterForm(l)}})},a)},On=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed"],Vn=function(t,e){var r=t.name,n=t.initialValues,a=t.fields,o=t.form,s=t.preserve,u=t.children,l=t.component,c=l===void 0?"form":l,f=t.validateMessages,v=t.validateTrigger,E=v===void 0?"onChange":v,F=t.onValuesChange,h=t.onFieldsChange,p=t.onFinish,d=t.onFinishFailed,w=it(t,On),m=x.exports.useContext(rt),V=$t(o),R=Fe(V,1),C=R[0],O=C.getInternalHooks(ce),M=O.useSubscribe,S=O.setInitialValues,A=O.setCallbacks,j=O.setValidateMessages,k=O.setPreserve,T=O.destroyForm;x.exports.useImperativeHandle(e,function(){return C}),x.exports.useEffect(function(){return m.registerForm(r,C),function(){m.unregisterForm(r)}},[m,C,r]),j(I(I({},m.validateMessages),f)),A({onValuesChange:F,onFieldsChange:function(D){if(m.triggerFormChange(r,D),h){for(var H=arguments.length,K=new Array(H>1?H-1:0),te=1;te<H;te++)K[te-1]=arguments[te];h.apply(void 0,[D].concat(K))}},onFinish:function(D){m.triggerFormFinish(r,D),p&&p(D)},onFinishFailed:d}),k(s);var G=x.exports.useRef(null);S(n,!G.current),G.current||(G.current=!0),x.exports.useEffect(function(){return T},[]);var z,P=typeof u=="function";if(P){var g=C.getFieldsValue(!0);z=u(g,C)}else z=u;M(!P);var b=x.exports.useRef();x.exports.useEffect(function(){pn(b.current||[],a||[])||C.setFields(a||[]),b.current=a},[a,C]);var L=x.exports.useMemo(function(){return I(I({},C),{},{validateTrigger:E})},[C,E]),N=x.exports.createElement(ke.Provider,{value:null},x.exports.createElement(ge.Provider,{value:L},z));return c===!1?N:x.exports.createElement(c,Le({},w,{onSubmit:function(D){D.preventDefault(),D.stopPropagation(),C.submit()},onReset:function(D){var H;D.preventDefault(),C.resetFields(),(H=w.onReset)===null||H===void 0||H.call(w,D)}}),N)};function Ot(i){try{return JSON.stringify(i)}catch{return Math.random()}}function Rn(){for(var i=arguments.length,t=new Array(i),e=0;e<i;e++)t[e]=arguments[e];var r=t[0],n=r===void 0?[]:r,a=t[1],o=a===void 0?{}:a,s=Lr(o)?{form:o}:o,u=s.form,l=x.exports.useState(),c=Fe(l,2),f=c[0],v=c[1],E=x.exports.useMemo(function(){return Ot(f)},[f]),F=x.exports.useRef(E);F.current=E;var h=x.exports.useContext(ge),p=u||h,d=p&&p._init,w=Y(n),m=x.exports.useRef(w);return m.current=w,x.exports.useEffect(function(){if(!!d){var V=p.getFieldsValue,R=p.getInternalHooks,C=R(ce),O=C.registerWatch,M=O(function(A,j){var k=se(s.preserve?j:A,m.current),T=Ot(k);F.current!==T&&(F.current=T,v(k))}),S=se(s.preserve?V(!0):V(),m.current);return f!==S&&v(S),M}},[d]),f}var Sn=x.exports.forwardRef(Vn),Ee=Sn;Ee.FormProvider=Cn;Ee.Field=Tt;Ee.List=yn;Ee.useForm=$t;Ee.useWatch=Rn;var An=x.exports.createContext({}),Dt=x.exports.createContext(null),Ln=Dt.Provider,It=x.exports.createContext(null),_n=It.Provider,qt={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(i){(function(){var t={}.hasOwnProperty;function e(){for(var r=[],n=0;n<arguments.length;n++){var a=arguments[n];if(!!a){var o=typeof a;if(o==="string"||o==="number")r.push(a);else if(Array.isArray(a)){if(a.length){var s=e.apply(null,a);s&&r.push(s)}}else if(o==="object"){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){r.push(a.toString());continue}for(var u in a)t.call(a,u)&&a[u]&&r.push(u)}}}return r.join(" ")}i.exports?(e.default=e,i.exports=e):window.classNames=e})()})(qt);var kn=qt.exports,Nn=["prefixCls","className","style","checked","disabled","defaultChecked","type","onChange"],jn=x.exports.forwardRef(function(i,t){var e,r=i.prefixCls,n=r===void 0?"rc-checkbox":r,a=i.className,o=i.style,s=i.checked,u=i.disabled,l=i.defaultChecked,c=l===void 0?!1:l,f=i.type,v=f===void 0?"checkbox":f,E=i.onChange,F=Bt(i,Nn),h=x.exports.useRef(null),p=St(c,{value:s}),d=Ht(p,2),w=d[0],m=d[1];x.exports.useImperativeHandle(t,function(){return{focus:function(){var O;(O=h.current)===null||O===void 0||O.focus()},blur:function(){var O;(O=h.current)===null||O===void 0||O.blur()},input:h.current}});var V=kn(n,a,(e={},ut(e,"".concat(n,"-checked"),w),ut(e,"".concat(n,"-disabled"),u),e)),R=function(O){u||("checked"in i||m(O.target.checked),E==null||E({target:lt(lt({},i),{},{type:v,checked:O.target.checked}),stopPropagation:function(){O.stopPropagation()},preventDefault:function(){O.preventDefault()},nativeEvent:O.nativeEvent}))};return x.exports.createElement("span",{className:V,style:o},x.exports.createElement("input",Yt({},F,{className:"".concat(n,"-input"),ref:h,onChange:R,disabled:u,checked:!!w,type:v})),x.exports.createElement("span",{className:"".concat(n,"-inner")}))}),Tn=globalThis&&globalThis.__rest||function(i,t){var e={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&t.indexOf(r)<0&&(e[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(e[r[n]]=i[r[n]]);return e},Mn=function(t,e){var r,n,a=x.exports.useContext(Dt),o=x.exports.useContext(It),s=x.exports.useContext(nt),u=s.getPrefixCls,l=s.direction,c=x.exports.useRef(),f=Xt(e,c),v=x.exports.useContext(An),E=v.isFormItemInput,F=function(A){var j,k;(j=t.onChange)===null||j===void 0||j.call(t,A),(k=a==null?void 0:a.onChange)===null||k===void 0||k.call(a,A)},h=t.prefixCls,p=t.className,d=t.children,w=t.style,m=Tn(t,["prefixCls","className","children","style"]),V=u("radio",h),R=((a==null?void 0:a.optionType)||o)==="button"?"".concat(V,"-button"):V,C=Ae({},m),O=x.exports.useContext(Kt);a&&(C.name=a.name,C.onChange=F,C.checked=t.value===a.value,C.disabled=(r=C.disabled)!==null&&r!==void 0?r:a.disabled),C.disabled=(n=C.disabled)!==null&&n!==void 0?n:O;var M=At("".concat(R,"-wrapper"),ve(ve(ve(ve({},"".concat(R,"-wrapper-checked"),C.checked),"".concat(R,"-wrapper-disabled"),C.disabled),"".concat(R,"-wrapper-rtl"),l==="rtl"),"".concat(R,"-wrapper-in-form-item"),E),p);return x.exports.createElement("label",{className:M,style:w,onMouseEnter:t.onMouseEnter,onMouseLeave:t.onMouseLeave},x.exports.createElement(jn,Ae({},C,{type:"radio",prefixCls:R,ref:f})),d!==void 0?x.exports.createElement("span",null,d):null)},$n=x.exports.forwardRef(Mn),Ne=$n,Dn=x.exports.forwardRef(function(i,t){var e=x.exports.useContext(nt),r=e.getPrefixCls,n=e.direction,a=x.exports.useContext(Qt),o=St(i.defaultValue,{value:i.value}),s=Zt(o,2),u=s[0],l=s[1],c=function(P){var g=u,b=P.target.value;"value"in i||l(b);var L=i.onChange;L&&b!==g&&L(P)},f=i.prefixCls,v=i.className,E=v===void 0?"":v,F=i.options,h=i.buttonStyle,p=h===void 0?"outline":h,d=i.disabled,w=i.children,m=i.size,V=i.style,R=i.id,C=i.onMouseEnter,O=i.onMouseLeave,M=i.onFocus,S=i.onBlur,A=r("radio",f),j="".concat(A,"-group"),k=w;F&&F.length>0&&(k=F.map(function(z){return typeof z=="string"||typeof z=="number"?x.exports.createElement(Ne,{key:z.toString(),prefixCls:A,disabled:d,value:z,checked:u===z},z):x.exports.createElement(Ne,{key:"radio-group-value-options-".concat(z.value),prefixCls:A,disabled:z.disabled||d,value:z.value,checked:u===z.value,style:z.style},z.label)}));var T=m||a,G=At(j,"".concat(j,"-").concat(p),ve(ve({},"".concat(j,"-").concat(T),T),"".concat(j,"-rtl"),n==="rtl"),E);return x.exports.createElement("div",Ae({},Fr(i),{className:G,style:V,onMouseEnter:C,onMouseLeave:O,onFocus:M,onBlur:S,id:R,ref:t}),x.exports.createElement(Ln,{value:{onChange:c,value:u,disabled:i.disabled,name:i.name,optionType:i.optionType}},k))}),In=x.exports.memo(Dn),qn=globalThis&&globalThis.__rest||function(i,t){var e={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&t.indexOf(r)<0&&(e[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(i);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(i,r[n])&&(e[r[n]]=i[r[n]]);return e},Un=function(t,e){var r=x.exports.useContext(nt),n=r.getPrefixCls,a=t.prefixCls,o=qn(t,["prefixCls"]),s=n("radio",a);return x.exports.createElement(_n,{value:"button"},x.exports.createElement(Ne,Ae({prefixCls:s},o,{type:"radio",ref:e})))},zn=x.exports.forwardRef(Un),je=Ne;je.Button=zn;je.Group=In;je.__ANT_RADIO=!0;var ze=je;const Re=(i,t)=>{const e=(90-t)*(Math.PI/180),r=(i+90)*(Math.PI/180);return{phi:e,theta:r}},Vt=(i,t,e)=>{const r=(180+t)*(Math.PI/180),n=(90-e)*(Math.PI/180);return{x:-i*Math.sin(n)*Math.cos(r),y:i*Math.cos(n),z:i*Math.sin(n)*Math.sin(r)}},Wn=(i,t,e)=>{const r=i.lengthSq(),n=t.lengthSq(),a=e.lengthSq(),o=i.x,s=i.y,u=t.x,l=t.y,c=e.x,f=e.y,v=o*l+u*f+c*s-s*u-l*c-f*o,E=(n*f+r*l+a*s-n*s-a*l-r*f)/v/2,F=(a*u+n*o+r*c-r*u-n*c-a*o)/v/2;return new Q(E,F,0)},Gn=(i,t)=>{const e=new Q(0,0,0),r=i.clone().sub(e),n=t.clone().sub(e),a=r.clone().cross(n).normalize(),o=new Q(0,0,1),s=new ct().setFromUnitVectors(a,o),u=i.clone().applyQuaternion(s),l=t.clone().applyQuaternion(s),f=u.clone().add(l).multiplyScalar(.5).clone().sub(e).normalize(),v=new Q(0,1,0),E=new ct().setFromUnitVectors(f,v),F=u.clone().applyQuaternion(E.clone()),h=l.clone().applyQuaternion(E.clone()),p=s.clone().invert().multiply(E.clone().invert());return{startSphere:F,endSphere:h,quaternion:p}};class Bn{constructor(t){B(this,"clock");B(this,"textLoader");B(this,"fileLoader");B(this,"fontLoad");B(this,"viewer");B(this,"uniforms",{});B(this,"labelRenderer");B(this,"controls");B(this,"R",100);B(this,"customUniforms",{baseTexture:{type:"t",value:{}},mixAmount:{type:"f",value:0}});B(this,"group3D",new Te);B(this,"group2D",new Te);B(this,"sphere");B(this,"onResize",()=>{const{width:t,height:e}=this.viewer.container.getBoundingClientRect(),r=t/e;this.viewer.renderer.setSize(t,e),this.labelRenderer.setSize(t,e),this.viewer.camera.aspect=r,this.viewer.camera.updateProjectionMatrix(),this.render()});B(this,"listen",()=>{window.addEventListener("resize",this.onResize)});B(this,"destroy",()=>{window.removeEventListener("resize",this.onResize)});B(this,"createEarth",t=>{this.textLoader.load("propagate/img/earth.png",e=>{this.customUniforms.baseTexture.value=e;const r=new ir(t,100,100),n=new Me({uniforms:this.customUniforms,vertexShader:`uniform float mixAmount;
                        varying vec2 vUv;
                        void main()
                        {
                            vUv = uv;
                          vec3 goalPosition = 200.0 * vec3( uv.x,uv.y/2.0, 0 ) + vec3(-100.0,-50.0, 0.0);
                          vec3 newPosition = mix( position, goalPosition, mixAmount );
                          gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );
                        }
                      `,fragmentShader:`uniform sampler2D baseTexture;
                          varying vec2 vUv;

                          void main()
                          {
                              gl_FragColor = texture2D( baseTexture, vUv );
                          }
                        `,side:$e,transparent:!0,opacity:1});this.sphere=new De(r,n),this.viewer.scene.add(this.sphere),this.render()})});B(this,"drawOutline",()=>{const t=this.R,e=new Te,r=new Me({uniforms:this.customUniforms,vertexShader:`uniform float mixAmount;
                     attribute vec3 current;
                        void main()
                        {
                          vec3 newPosition = mix( position, current, mixAmount );
                          gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );
                        }
                      `,fragmentShader:`void main()
                        {
                            gl_FragColor = vec4(1.0,1.0,1.0,0.2);
                        }
                      `,side:$e,transparent:!0});this.fileLoader.load("propagate/data/world.json",n=>{n.features.forEach(a=>{if(a.geometry.type==="Polygon"){const o=[],s=[],u=a.geometry.coordinates[0]||[];if(u.length===0)return;u.forEach(l=>{o.push(l[0],l[1],0);const c=Vt(t*1.001,l[0],l[1]);s.push(c.x,c.y,c.z)}),e.add(this.drawLineLoop(o,s,r))}else a.geometry.type==="MultiPolygon"&&a.geometry.coordinates.forEach(o=>{const s=[],u=[],l=o[0]||[];l.length!==0&&(l.forEach(c=>{s.push(c[0],c[1],0);const f=Vt(t*1.001,c[0],c[1]);u.push(f.x,f.y,f.z)}),e.add(this.drawLineLoop(s,u,r)))})}),this.viewer.scene.add(e),this.render()},n=>{this.viewer.onProgress("propagate/data/world.json",n)})});B(this,"drawLineLoop",(t,e,r)=>{const n=new Oe,a=new Float32Array(e);return n.setAttribute("position",new ft(a,3)),n.setAttribute("current",new ft(new Float32Array(t),3)),new ar(n,r)});B(this,"drawShpae",(t,e)=>{const r=[];t.forEach(s=>{r.push(new or(s[0],s[1]))});const n=new sr(r),a=new ur(n);return new De(a,e)});B(this,"drawLines",(t,e)=>{const r=new lr({color:14737632});e.forEach(n=>{const{to:a,name:o,isLine:s}=n;if(!a||!s||o==="\u66F2\u961C")return;const{fly:u,point:l}=this.draw2DLine(n,r);this.group2D.add(u,l);const{fly:c,point:f}=this.draw3DLine(n,r);this.group3D.add(c,f),this.render()})});B(this,"drawFlyLine",(t,e,r)=>{const n=[],a=[],o=[],s=[];t.forEach((f,v)=>{const E=v/(e-1);n.push({x:f.x,y:f.y,z:f.z}),o.push(E),s.push(v)}),n.forEach(f=>{a.push(f.x,f.y,f.z)});const u=new Oe;u.setFromPoints(t),u.setAttribute("position",new Ie(a,3)),u.setAttribute("index",new Ie(o,1)),u.setAttribute("current",new Ie(s,1)),this.uniforms[r]={uColor:{value:new dr(710128)},uRange:{value:20},uSize:{value:6},uTotal:{value:e},uTime:{value:0},uSpeed:{value:(Math.random()*4+4)/10}};const l=new Me({transparent:!0,depthWrite:!1,depthTest:!1,blending:hr,uniforms:this.uniforms[r],vertexShader:`
        attribute float index;
        attribute float current;
        uniform float uTime;
        uniform float uSize;
        uniform float uSpeed;
        uniform float uRange; // \u5C55\u793A\u533A\u95F4
        uniform float uTotal; // \u7C92\u5B50\u603B\u6570
        uniform vec3 uColor;
        varying vec3 vColor;
        varying float vOpacity;
        void main() {
            // \u9700\u8981\u5F53\u524D\u663E\u793A\u7684\u7D22\u5F15
            float size = uSize;
            float showNumber = uTotal * mod(uTime * uSpeed, 1.1);
            if (showNumber > current && showNumber < current + uRange) {
                float uIndex = ((current + uRange) - showNumber) / uRange;
                size *= uIndex;
                vOpacity = 1.0;
            } else {
                vOpacity = 0.0;
            }
            // \u9876\u70B9\u7740\u8272\u5668\u8BA1\u7B97\u540E\u7684Position
            vColor = uColor;
            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
            gl_Position = projectionMatrix * mvPosition;
            // \u5927\u5C0F
            gl_PointSize = size * 300.0 / (-mvPosition.z);
        }`,fragmentShader:`
        varying vec3 vColor;
        varying float vOpacity;
        void main() {
            float distanceToCenter = distance(gl_PointCoord,vec2(0.5));
            float strength = 1.0 - (distanceToCenter * 2.0);
            if(vOpacity <= 0.0){
              gl_FragColor = vec4(vColor, 0.0);
            }else{
              gl_FragColor = vec4(vColor, strength);
            }
        }`});return new vr(u,l)});B(this,"drawLocation",(t,e=!1)=>{const r=new pr({transparent:!0,side:$e});this.textLoader.load("propagate/img/136.png",n=>{t.forEach(a=>{const{to:o,size:s}=a,u=Number(s)+2,l=e?s:u>16?16:u;if(!o)return;const{x:c,y:f,z:v}=new Q(o[0],o[1],0),E=new gr(l,l);r.map=n;const F=new De(E,r);F.position.set(c,f,v+.02),this.group2D.add(F);const h=F.clone(),{phi:p,theta:d}=Re(o[0],o[1]);h.position.setFromSphericalCoords(100,p,d);const w=new Q;w.copy(h.position).multiplyScalar(2),h.lookAt(w),this.group3D.add(h)}),this.render()})});B(this,"update",()=>{const t=this.clock.getElapsedTime();Object.keys(this.uniforms).forEach(e=>{this.uniforms[e].uTime.value=t}),this.render()});t.useLoadingManager(),t.scene.add(this.group3D),this.viewer=t,this.textLoader=new er,this.textLoader.setCrossOrigin(""),this.fileLoader=new tr(t.loadmanager),this.fileLoader.setResponseType("json"),this.fontLoad=new yr(t.loadmanager),this.clock=new rr,this.uniforms={},this.listen()}useCss3Render(){const{width:t,height:e}=this.viewer.container.getBoundingClientRect();this.labelRenderer=new br,this.labelRenderer.setSize(t,e),this.labelRenderer.domElement.style.position="absolute",this.labelRenderer.domElement.style.top="0px";const r=this.labelRenderer.domElement;r.id="tempId",this.viewer.container.appendChild(r),this.controls=new nr(this.viewer.camera,r),this.controls.addEventListener("change",()=>{this.render()}),this.controls.enablePan=!1,this.controls.minDistance=50,this.controls.maxDistance=250,this.controls.mouseButtons={LEFT:ie.ROTATE,MIDDLE:ie.DOLLY,RIGHT:ie.PAN}}startGame(){this.viewer.scene.translateX(-10),this.viewer.scene.translateY(-15),this.loadSky(),this.drawLocation([{to:[117.045982,35.794391],size:35}],!0),this.fileLoader.load("propagate/data/map.json",t=>{this.useCss3Render();const e=this.R;this.createEarth(e),this.drawOutline(),this.drawLines(e,t),this.createText(t),this.drawLocation(t)},t=>{this.viewer.onProgress("propagate/data/map.json",t)})}render(){var t;this.viewer.render(),(t=this.labelRenderer)==null||t.render(this.viewer.scene,this.viewer.camera)}loadSky(){this.textLoader.load("propagate/img/bg.png",t=>{this.viewer.scene.background=t,this.render()})}draw2DLine(t,e){const{from:r,to:n,name:a}=t,o=new Q(r[0],r[1],0),s=new Q(n[0],n[1],0),u=o.clone().lerp(s,.5),l=o.clone().distanceTo(s);u.z+=l/3;const c=new cr(o,u,s),f=c.getLength()*4,v=c.getPoints(f),E=new Oe().setFromPoints(v),F=new dt(E,e),h=this.drawFlyLine(v,f,`${a}2d`);return{fly:F,point:h}}draw3DLine(t,e){const r=this.R,{from:n,to:a,name:o}=t,{phi:s,theta:u}=Re(n[0],n[1]),l=new Q().setFromSphericalCoords(100,s,u),{phi:c,theta:f}=Re(a[0],a[1]),v=new Q().setFromSphericalCoords(100,c,f),E=Gn(l,v),F=E.startSphere,h=E.endSphere,p=F.clone().lerp(h,.5).normalize(),d=Rt(F,h,new Q(0,0,0)),w=p.multiplyScalar(r+r*d*.1),m=Wn(F,h,w),V=Math.abs(m.y-w.y),R=Rt(F,new Q(0,-1,0),m),C=-Math.PI/2+R,O=Math.PI-C,M=new fr(m.x,m.y,V,C,O,!1),S=M.getLength()*4,A=M.getPoints(S),j=new Oe().setFromPoints(A),k=new dt(j,e);k.quaternion.multiply(E.quaternion);const T=this.drawFlyLine(A.map(G=>new Q(G.x,G.y,0).applyQuaternion(E.quaternion)),S,`${o}3d`);return{fly:k,point:T}}createText(t){t.forEach(e=>{const{to:r,name:n,size:a,isLine:o}=e;if(!n||!o||!r)return;const s=document.createElement("div");s.style.fontSize=n==="\u66F2\u961C"?"20px":"12px",s.style.color="#ffffff",s.style.position="absolute",s.style.fontFamily="HanaA",s.style.whiteSpace="nowrap";let u=`<span>${n}</span> `;a>1&&(u+=`<span style="font-size:28px;vertical-align: sub;">${a}</span> <span>\u6240</span>`),s.innerHTML=u;const l=new wr(s);l.name="2d",l.position.set(r[0],r[1]-1,0),l.scale.set(.15,.15,.15),n=="\u66F2\u961C"&&(l.scale.set(.2,.2,.2),l.position.set(r[0],r[1]-4,0)),this.group2D.add(l);const c=l.clone();c.name="3d";const{phi:f,theta:v}=Re(r[0],r[1]);c.position.setFromSphericalCoords(100,f,v);const E=new Q;E.copy(c.position).multiplyScalar(2),c.lookAt(E),c.scale.set(.15,.15,.15),n=="\u66F2\u961C"&&c.scale.set(.2,.2,.2),this.group3D.add(c),this.render()})}}const Rt=(i,t,e)=>{const r=i.clone().sub(e).normalize(),n=t.clone().sub(e).normalize(),a=r.clone().dot(n);return Math.acos(a)},Jn=()=>{const i=x.exports.useRef(null),[t,e]=x.exports.useState("3D"),[r,n]=x.exports.useState(),[a,o]=x.exports.useState();return x.exports.useEffect(()=>{if(!i.current)return;const s=new mr(i.current);o(s),s.useOrbitControls();const u=new Bn(s);n(u),u.startGame();let l;const c=()=>{u.update(),l=requestAnimationFrame(c)};return c(),()=>{cancelIdleCallback(l)}},[]),Ce("div",{className:"w-100% h-100% relative",children:Ce("div",{className:"gunplay w-100% h-100% ",ref:i,children:Jt(ze.Group,{className:"absolute top-20px right-20px z-999",buttonStyle:"solid",value:t,onChange:s=>{const u=s.target.value;if(!r)return;let l=u==="2D"?0:1;u==="2D"?(a==null||a.scene.remove(r.group3D),r.group3D.traverse(f=>{f.name==="3d"&&(f.element.style.display="none")}),r.controls.enablePan=!0,r.controls.enableRotate=!1,r.controls.mouseButtons={LEFT:ie.PAN,MIDDLE:ie.DOLLY,RIGHT:ie.ROTATE}):(a==null||a.scene.remove(r.group2D),r.group2D.traverse(f=>{f.name==="2d"&&(f.element.style.display="none")}),r.controls.enablePan=!1,r.controls.enableRotate=!0,r.controls.mouseButtons={LEFT:ie.ROTATE,MIDDLE:ie.DOLLY,RIGHT:ie.PAN}),r.controls.reset();const c=()=>{u==="2D"?l+=.01:l-=.01,l<1.01&&l>-.01?(r.sphere.scale.set(1+l*.8,1+l*.8,1+l*.8),r.customUniforms.mixAmount.value=l,requestAnimationFrame(c)):u==="2D"?(a==null||a.scene.add(r.group2D),r.group2D.traverse(f=>{f.name==="2d"&&(console.log("yyy"),f.element.style.display="block")})):(a==null||a.scene.add(r.group3D),r.group3D.traverse(f=>{f.name==="3d"&&(f.element.style.display="block")}))};c(),e(u)},children:[Ce(ze.Button,{value:"2D",children:"2D"}),Ce(ze.Button,{value:"3D",children:"3D"})]})})})};export{Jn as default};
